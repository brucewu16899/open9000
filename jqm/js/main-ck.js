function initialize(){var e={zoom:13,center:new google.maps.LatLng(51.05,3.7167),mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map_canvas"),e);mc=new MarkerClusterer(map)}function MVCfun(){var e=new DistanceWidget(map);google.maps.event.addListener(e,"distance_changed",function(){displayInfo(e)});google.maps.event.addListener(e,"position_changed",function(){displayInfo(e)})}function displayInfo(e){var t=document.getElementById("info");t.innerHTML="Position: "+e.get("position")+", distance: "+e.get("distance")}function geolocation(){Modernizr.geolocation?navigator.geolocation.getCurrentPosition(geoSuccess,geoError,{timeout:1e4,enableHighAccuracy:!0}):alert("You have an ancient browser. Please upgrade to Chrome.")}function geoSuccess(e){var t=e.coords;myGeoMarker=new google.maps.Marker({position:new google.maps.LatLng(t.latitude,t.longitude),map:map,title:"My location"});centermap()}function centermap(){var e=myGeoMarker.getPosition();map.setCenter(e)}function geoError(e){console.log(e)}function getParking(){$.getJSON(parkingurl,function(e){infowindow=new google.maps.InfoWindow({content:""});var t="img/parking.png";$.each(e.Parkings.parkings,function(e,n){n.availableCapacity>=500?t="img/4+.png":n.availableCapacity>=200?t="img/2+.png":t="img/2.png";parkingMarker=new google.maps.Marker({position:new google.maps.LatLng(n.latitude,n.longitude),title:n.description,icon:t});parkingMarker.setMap(map);google.maps.event.addListener(parkingMarker,"click",function(){var e=n.description,t=n.address,r=n.contactInfo;$("#parking-content h1").html(e);$("#parking-content p").html(t);$("#parking-content a").html(r)});bindInfoWindow(parkingMarker,map,infowindow,"<h1>"+this.description+"</h1>"+"<p>Places left: "+this.availableCapacity+'</p><a href="#parking" data-transition="slide">go</a>')})})}function bindInfoWindow(e,t,n,r){google.maps.event.addListener(parkingMarker,"click",function(){n.setContent(r);n.open(t,parkingMarker)})}function getSport(){$.getJSON(sportnurl,function(e){var t="img/weights.png";$.each(e.sportgent,function(e,n){marker=new google.maps.Marker({position:new google.maps.LatLng(n.lat,n.long),map:map,title:"Sport centra",icon:t})})})}function getCellen(){$.getJSON(telefooncellenurl,function(e){var t="img/telephone.png",n=[];$.each(e.telefooncellen,function(e,r){marker=new google.maps.Marker({position:new google.maps.LatLng(r.lat,r.long),map:map,title:"Telefoon cellen",icon:t});n.push(marker)});mc=new MarkerClusterer(map,n)})}function getApotheken(){$.getJSON(apothekenurl,function(e){var t="img/drugstore.png",n=[];$.each(e.apotheken,function(e,r){marker=new google.maps.Marker({position:new google.maps.LatLng(r.lat,r.long),map:map,title:"Apotheken",icon:t});n.push(marker)});mc=new MarkerClusterer(map,n)})}function getSani(){$.getJSON(sanitairurl,function(e){var t="img/toilets.png",n=[];$.each(e.publieksanitair,function(e,r){var i=new google.maps.LatLng(r.lat,r.long);marker=new google.maps.Marker({position:i,map:map,title:"Publiek sanitair",icon:t});n.push(marker)});mc=new MarkerClusterer(map,n)})}function getBios(){$.getJSON(bioscopenurl,function(e){var t="img/cinema.png";$.each(e.bioscopen,function(e,n){marker=new google.maps.Marker({position:new google.maps.LatLng(n.lat,n.long),map:map,title:"Bioscopen",icon:t})})})}function getBib(){$.getJSON(bibliothekenurl,function(e){var t="img/book.png";$.each(e.bibliotheken,function(e,n){marker=new google.maps.Marker({position:new google.maps.LatLng(n.lat,n.long),map:map,title:"Bibliotheken",icon:t})})})}function getArts(){$.getJSON(huisartsenwachtposturl,function(e){var t="img/medicine.png";$.each(e.huisartsenwachtposten,function(e,n){marker=new google.maps.Marker({position:new google.maps.LatLng(n.lat,n.long),map:map,title:"Huisartsenwachtposten",icon:t})})})}function getSchool(){$.getJSON(schoolennurl,function(e){var t="img/cramschool.png",n=[];$.each(e.secundairescholen,function(e,r){marker=new google.maps.Marker({position:new google.maps.LatLng(r.lat,r.long),map:map,title:"Schoolen",icon:t});n.push(marker)});mc=new MarkerClusterer(map,n)})}function getZiekenhuis(){$.getJSON(ziekenhuizenurl,function(e){var t="img/firstaid.png";$.each(e.ziekenhuizen,function(e,n){marker=new google.maps.Marker({position:new google.maps.LatLng(n.lat,n.long),map:map,title:"Ziekenhuizen",icon:t})})})}function checkState(){if(localStorage.apo==="checked"){$("#apo").attr("checked","checked");$(".apo").addClass("ui-checkbox-on");$(".apo span").addClass("ui-icon-checkbox-on");getApotheken()}if(localStorage.arts==="checked"){$("#arts").attr("checked","checked");$(".arts").addClass("ui-checkbox-on");$(".arts span").addClass("ui-icon-checkbox-on");getArts()}if(localStorage.bib==="checked"){$("#bib").attr("checked","checked");$(".bib").addClass("ui-checkbox-on");$(".bib span").addClass("ui-icon-checkbox-on");getBib()}if(localStorage.bios==="checked"){$("#bios").attr("checked","checked");$(".bios").addClass("ui-checkbox-on");$(".bios span").addClass("ui-icon-checkbox-on");getBios()}if(localStorage.cellen==="checked"){$("#cellen").attr("checked","checked");$(".cellen").addClass("ui-checkbox-on");$(".cellen span").addClass("ui-icon-checkbox-on");getCellen()}if(localStorage.school==="checked"){$("#school").attr("checked","checked");$(".school").addClass("ui-checkbox-on");$(".school span").addClass("ui-icon-checkbox-on");getSchool()}if(localStorage.parking==="checked"){$("#parking").attr("checked","checked");$(".parking").addClass("ui-checkbox-on");$(".parking span").addClass("ui-icon-checkbox-on");getParking()}if(localStorage.sport==="checked"){$("#sport").attr("checked","checked");$(".sport").addClass("ui-checkbox-on");$(".sport span").addClass("ui-icon-checkbox-on");getSport()}if(localStorage.sani==="checked"){$("#sani").attr("checked","checked");$(".sani").addClass("ui-checkbox-on");$(".sani span").addClass("ui-icon-checkbox-on");getSani()}if(localStorage.ziek==="checked"){$("#ziek").attr("checked","checked");$(".ziek").addClass("ui-checkbox-on");$(".ziek span").addClass("ui-icon-checkbox-on");getZiekenhuis()}}function DistanceWidget(e){this.set("map",e);this.set("position",e.getCenter());var t=new google.maps.Marker({draggable:!0,title:"Move me!"});t.bindTo("map",this);t.bindTo("position",this);var n=new RadiusWidget;n.bindTo("map",this);n.bindTo("center",this,"position");this.bindTo("distance",n);this.bindTo("bounds",n)}function RadiusWidget(){var e=new google.maps.Circle({strokeweight:1});this.set("distance",2);this.bindTo("bounds",e);e.bindTo("center",this);e.bindTo("map",this);e.bindTo("radius",this);this.addSizer_()}var map,infowindow,mc,parkingurl="http://datatank.gent.be/Mobiliteitsbedrijf/Parkings.json",sportnurl="http://data.appsforghent.be/poi/sportgent.json",ziekenhuizenurl="http://data.appsforghent.be/poi/ziekenhuizen.json",apothekenurl="http://data.appsforghent.be/poi/apotheken.json",bibliothekenurl="http://data.appsforghent.be/poi/bibliotheken.json",bioscopenurl="http://data.appsforghent.be/poi/bioscopen.json",huisartsenwachtposturl="http://data.appsforghent.be/poi/huisartsenwachtposten.json",schoolennurl="http://data.appsforghent.be/poi/secundairescholen.json",sanitairurl="http://data.appsforghent.be/poi/publieksanitair.json",telefooncellenurl="http://data.appsforghent.be/poi/telefooncellen.json";DistanceWidget.prototype=new google.maps.MVCObject;RadiusWidget.prototype=new google.maps.MVCObject;RadiusWidget.prototype.distance_changed=function(){this.set("radius",this.get("distance")*1e3)};RadiusWidget.prototype.addSizer_=function(){var e=new google.maps.Marker({draggable:!0,title:"Drag me"});e.bindTo("map",this);e.bindTo("position",this,"sizer_position");var t=this;google.maps.event.addListener(e,"drag",function(){t.setDistance()})};RadiusWidget.prototype.center_changed=function(){var e=this.get("bounds");if(e){var t=e.getNorthEast().lng(),n=new google.maps.LatLng(this.get("center").lat(),t);this.set("sizer_position",n)}};RadiusWidget.prototype.distanceBetweenPoints_=function(e,t){if(!e||!t)return 0;var n=6371,r=(t.lat()-e.lat())*Math.PI/180,i=(t.lng()-e.lng())*Math.PI/180,s=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(t.lat()*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2),o=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),u=n*o;return u};RadiusWidget.prototype.setDistance=function(){var e=this.get("sizer_position"),t=this.get("center"),n=this.distanceBetweenPoints_(t,e);this.set("distance",n)};$(function(){initialize();geolocation();checkState();$("input[type=checkbox]").change(function(){localStorage[$(this).attr("id")]=$(this).attr("checked");checkState()})});